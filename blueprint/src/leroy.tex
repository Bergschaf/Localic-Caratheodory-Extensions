\begin{comment}
\chapter{Leroy Chapter II}\label{sec:leroy-chapter-ii}
\begin{definition}[Induced boolean algebra]
    \label{def:induced_boolean_algebra}
    Define $At(U_1,\dots,U_n)$ as the collection of all finite nonempty intersections of opens $U_i$ or their complements. \\
    Define $b(U_1,\dots,U_n)$ as all unions of elements of $At(U_1,\dots,U_n)$\\
    Define $b(X)$ as the union of all $b(U_1,\dots,U_n)$ for finite collections of opens $U_i$.
\end{definition}

\begin{lemma}[(2.1) Sublocals and decompositions]
    \label{lem:sublocals_and_decompositions}
    \uses{def:induced_boolean_algebra,lem:preimage_of_complements,lem:distribution_of_intersections_over_unions}
    For any open $U$ the natural morphism $p : U \sqcup (E \setminus U)$ induces a bijection of sublocals.
\end{lemma}

\begin{lemma}[(2.2) Induced morphism of boolean algebras]
    \label{lem:induced_morphism_of_boolean_algebras}
    \uses{def:induced_boolean_algebra,lem:preimage_of_complements}
    For all $H \in B(U_1,\dots,U_n)$ we have $f^{-1}(H) \in b(f^{-1}(U-1),\dots,f^{-1}(U_n))$ and \[H \mapsto f^{-1}(H)    \]
    Is a morphism of boolean algebras
\end{lemma}

\begin{proposition}[Boolean algebra]
(Leroy Proposition II.1)
    \label{prop:boolean_algebra}
    \uses{lem:induced_morphism_of_boolean_algebras}
    \begin{enumerate}
        \item $b(X)$ is the generated boolean algebra of the open and closed sublocals of $X$.
        \item For all $H \in b(X)$, we have $f^{-1}(H) \in b(Y)$ and the map $H \to f^{-1}(H)$ is a homomorphism of boolean algebras $b(X) \to b(Y)$
        \item For two sublocals $A, B$ of $X$ and any $H \in b(X)$, we have: \[H \cap (A \cup B ) = (H \cap A) \cup (H \cap B)\]
    \end{enumerate}
\end{proposition}

\begin{lemma}[$b(X)$ generates sublocals]
    Every sublocal $X$ is an intersection of elements of $b(X)$.
    \label{lem:b_X_generates_sublocals}
    \uses{def:induced_boolean_algebra}
\end{lemma}


\begin{lemma}[Union of Intersections]
(Leroy Lemme 2.4)
    \label{lem:union_of_intersections}
    \uses{def:sublocal_intersection,prop:boolean_algebra,lem:b_X_generates_sublocals}
    For any family $B_i$ of sublocals of a local $E$ and a sublocal $A$, we have:
    \[A \cup (\bigcap_i B_i) = \bigcap_i (A \cap B_i)\]
    This implies if $A_i$ and $B_j$ are families of sublocals of $X$, we have:
    \[(\bigcap_i A_i)\cup(\bigcap_j B_j) =  \bigcap_{ij}(A_i \cup B_j)\]
\end{lemma}


\begin{theorem}[Preimage commutes with unions]
(Leroy resultat principal)
    \label{thm:preimage_commutes_with_unions}
    \uses{lem:union_of_intersections,def:inverse_images}
    For any morphism $f$ of locals, we have:
    \[f^{-1}(A \cup B) = f^{-1}(A) \cup f^{-1}(B)\]
\end{theorem}

\end{comment}
\chapter{Leroy Chapter III}\label{sec:leroy-chapter-iii}
\begin{definition}[Measure on Locals]
    \label{def:measure_on_locals}
    \uses{def:open_sublocal,lem:sublocal_properties} 
    \lean{Measure}
    \leanok
    A measure on a local $X$ is a map $\mu : O(X) \to [0,\infty)$ such that:
    \begin{enumerate}
        \item $\mu(\emptyset) = 0$
        \item $U \subset V \implies \mu(U) \le \mu(V)$
        \item $\mu(U \cup V) = \mu(U) + \mu(V) - \mu(V \cap V)$
        \item For any increasingly filtered family $V_i$ of open sublocals of $X$, we have:
        \[\mu(\bigcup V_i) = \sup_i \mu(V_i)\] this means:
        For all $i$ and $j$ there exists a $k$ such that $V_i \cup V_j \subset V_k$ bzw. $V_i \subset V_k$ and $V_j \subset V_k$.
    \end{enumerate}
    (Leroy III.1.)
\end{definition}

\begin{definition}[Caratheodory]
    \lean{Measure.caratheodory}
    \leanok
    \label{def:caratheodory}
    \uses{def:measure_on_locals}
    For any measure on a local $X$, the caratheodory extension is:
    \[\mu(A) = \inf \{\mu(U) | A \subset U \in O(X)\}\]
\end{definition}

\begin{lemma}[Proptery 0 (Commutes with sup)]
(Leroy lemme 3.1)
    \label{lem:commutes_with_sup}
    \uses{def:measure_on_locals,def:caratheodory}
    \leanok
    The caratheodory extension of a measure on a local commutes with unions of increasing families.
    (Senf von noa: commutes with filtered colimits)
\end{lemma}

\begin{lemma}[Caratheodory Extensions are monotonic]
    \label{lem:monotonic}
    \uses{def:measure_on_locals,def:caratheodory}
    \lean{Measure.caratheodory.monotonic}
    \leanok
    The caratheodory extension is monotonic i.e. \[A \le B \implies \mu (A) \le \mu (B)\]
\end{lemma}
\begin{proof}
    \leanok
    This is a direct consequence of the definition of the caratheodory extension.
\end{proof}

\begin{lemma}[Subadditivity]
    \label{lem:caratheodory_subaddtive}
    \uses{def:measure_on_locals,lem:monotonic}
    \lean{Measure.caratheodory.subadditive}
    The Caratheodory extension is subaddtive:
    $$\mu(A \cup B) \le \mu(A) + \mu(b)$$
    \leanok
\end{lemma}
\begin{proof}
    \leanok
\end{proof}

\begin{definition}[Regular Local]
    \label{def:regular_local}
    \uses{def:open_sublocal, def:further_topology}
    \lean{regular}
    \leanok
    A local is regular, if for all open sublocals $U$ of $E$, the open sublocals $V$ such that $V\bar \subset U$ recover $U$.
\end{definition}



\begin{definition}[Neighborhood]
    \label{def:neighborhood}
    \uses{def:open_sublocal}
    \lean{Sublocale.Neighbourhood}
    \leanok

    A neighborhood of a sublocal $A$ of $X$ is an open sublocal $V$ of $X$ such that $A \le V$.
\end{definition}

\begin{lemma}[Regularity of Sublocals]
(Leroy lemme 3.2)
    \label{lem:regularity_of_sublocals}
    \lean{sublocal_intersection_of_neighbours}
    \leanok
    \uses{def:regular_local, def:neighborhood}
    In a regular local, any sublocal is regular, meaning that it is the intersection of all open neighborhoods.
\end{lemma}


\begin{lemma}[Measure add compl eq top]
(Leroy Lemme 3.3)
    \label{lem:measure_add_compl_eq_top}
    \uses{def:complement, lem:commutes_with_sup, lem:regularity_of_sublocals,lem:properties_of_further_topology}
    \lean{Measure.add_complement}
    \leanok
    For any open sublocal $U$ of a local $X$, the caratheodory extension of a measure on $X$ satisfies \[\mu(U) + \mu(X \setminus U) = \mu(X)\]
\end{lemma}
\begin{proof}
    \leanok
    Siehe Leroy
\end{proof}



\begin{lemma}[Restriction]
    The Restriction of a Measure to any open Sublocal is a Measure.
    \label{lem:restriction}
    \uses{def:measure_on_locals}
    \lean{Measure.restrict_measure}
    \leanok
\end{lemma}
\begin{proof}
    \uses{lem:commutes_with_sup}
\leanok
\end{proof}

\begin{lemma}[Property 2]
(Leroy Lemm 3.4)
    \label{lem:restrict_add_compl_eq_top}
    \lean{Measure.add_complement_inf}
    \leanok
    \uses{def:complement,def:sublocal_intersection,lem:measure_add_compl_eq_top,lem:restriction, lem:caratheodory_subaddtive}
    For any open sublocal $U$ and any sublocal $A$ of a local $E$, the caratheodory extension of a measure on $X$ satisfies \[\mu(A) = \mu(A \cap U) + \mu(A \cap(E\setminus U))\]
\end{lemma}
\begin{proof}
    Siehe Leroy
    \leanok
\end{proof}

\begin{lemma}[Property 3]
(Leroy Lemm 3.5)
    \label{lem:restrict_preserves_sSup}
    \uses{lem:restrict_add_compl_eq_top,lem:commutes_with_sup}
    \lean{Measure.inf_filtered}
    \leanok
    For a increasing family $V_{\alpha}$ of open sublocals of $E$ and any sublocal $A$, we have:
    \[\mu(A \cap(\bigcup V_{\alpha})) = \sup_\alpha \mu(A\cap V_\alpha)\]
\end{lemma}
\begin{proof}
    \leanok
\end{proof}

\begin{lemma}[Restriction to a Sublocale]
    Let $A$ be a sublocale of $E$ with the embedding $i : A \rightarrow E$. The restriction of a measure $\mu$ on $E$ to $A$ is a measure on $A$:
    $$V \mapsto \mu(i(V)) : Open(A) \to \mathbb{R}$$
    \label{lem:restriction_to_sublocale}
    \uses{lem:restrict_preserves_sSup}
    \lean{Measure.restrict_sublocale_measure}
    \leanok
\end{lemma}

\begin{comment}
\begin{proposition}[Elementary Properties of Caratheodory Extensions]
(Leroy lemme 3.3, 3.4, Corollary 3.1, Lemme 3.5)
    \label{prop:elementary_properties_of_caratheodory_extensions}
    \uses{lem:measure_add_compl_eq_top,lem:restrict_add_compl_eq_top,lem:commutes_with_sup, lem:restrict_preserves_sSup,lem:monotonic}
    For any measure on a local $X$, the caratheodory extension satisfies the following properties:
    \begin{enumerate}
        \item It is monotonic i.e. \[A \le B \implies \mu (A) \le \mu (B)\]
        \item Commutes with unions of increasing families
        \item $\mu(U) + \mu(X \setminus U) = \mu(X)$
        \item $\mu(A) = \mu(A \cap U) + \mu(A \cap(E\setminus U))$
        \item For a increasing family $V_{\alpha}$ of open sublocals of $E$ and any sublocal $A$, we have:
        \[\mu(A \cap(\bigcup V_{\alpha})) = \sup_\alpha \mu(A\cap V_\alpha)\]
        \item For any measure on a local $X$ and a decreasing family $V_i$ of open sublocals, the caratheodory extension fulfills: $\mu (\inf V_i) = \inf \mu(V_i)$.
    \end{enumerate}
    In particular, for two open sublocals $U$ and $V$ of $X$ and any sublocal $A$ of $X$, we have
    \[\mu(A \cap (U \cup V)) = \mu(A\cap U) + \mu(A\cap V) - \mu(A \cap U \cap V)\]
\end{proposition}
\end{comment}


\begin{proposition}[strictly additve]
(Leroy theorem 3.3.1)
    \label{prop:strictly_additive}
    \uses{prop:commutes_with_inf,lem:regularity_of_sublocals}
    \leanok
    \lean{Measure.caratheodory.strictly_additive}
    For any measure on a local $X$, the caratheodory extension is
    strictly additive i.e. $\mu (A \cup B) = \mu(A) + \mu(B) - \mu(A \cap B)$
\end{proposition}
\begin{proof}
    \leanok
\end{proof}


\begin{proposition}[reductive]
    \label{prop:reductive}  (Proposition 3.3.1)
    \uses{def:sublocal, prop:elementary_properties_of_caratheodory_extensions,lem:regularity_of_sublocals,lem:restriction_to_sublocale}
    For any measure on a local $X$, the caratheodory extension is
    reductive i.e. for all $A \le X$ the set $\{A' \subset A, \mu(A') = \mu(A)\}$ has a minimal element
\end{proposition}



\begin{lemma}[Commutes with inf opens]
(Leroy Lemme 3.6)
    \label{lem:commutes_with_inf_opens}
    \uses{lem:measure_add_compl_eq_top,lem:nucleus_frame}
    \lean{Measure.caratheodory.preserves_sInf}
    \leanok
    For any measure on a local $X$ and a decreasing family $V_i$ of open sublocals, the caratheodory extension fulfills: $\mu (\inf V_i) = \inf \mu(V_i)$.
\end{lemma}
\begin{proof}
    \leanok
\end{proof}

\begin{proposition}[Commutes with inf]
(Leroy lemme 3.7 et principal)
    \label{prop:commutes_with_inf}
    \uses{prop:reductive,lem:commutes_with_inf_opens,lem:regularity_of_sublocals,prop:elementary_properties_of_caratheodory_extensions}
    For any measure on a local $X$, the caratheodory extension is
    regular $\mu (\inf A_i) = \inf \mu(A_i)$. For decreasing families $A_i$
\end{proposition}

\begin{theorem}[Main Theorem (very important)]
    \label{thm:main}
    \uses{prop:strictly_additive,prop:commutes_with_inf,prop:reductive}
    For any measure on a local $X$, the caratheodory extension is
    \begin{enumerate}
        \item strictly additive i.e. $\mu (A \cup B) = \mu(A) + \mu(B) - \mu(A \cap B)$
        \item commutes with inf $\mu (\inf A_i) = \inf \mu(A_i)$
        \item reductive i.e. for all $A \le X$ the set $\{A' \subset A, \mu(A') = \mu(A)\}$ has a minimal element
    \end{enumerate}
\end{theorem}


\chapter{Leroy Chapter V}\label{sec:leroy-chapter-v}


\begin{lemma}[Regular Top to regular local]
    \label{lem:regular_top_to_regular_local}
    \uses{def:good_enough_topological_space, def:regular_local}
    Any regular topological space induces a regular local.
\end{lemma}

\begin{lemma}[Opens]
(Leroy V.1 Remarque 2)
    \label{lem:opens_correspond}
    \uses{def:open_sublocal}
    The Open subsets of any good enough topological space correspond precisely to the open sublocals of the corresponding local.
\end{lemma}

\begin{lemma}[Subset Sublocal]
(leroy V.1 Remarque 3)
    \label{lem:subset_sublocal}
    \uses{def:good_enough_topological_space}
    Any subset $X$ of a good enough topological space $E$ induces a sublocal $[X]$ of the corresponding local. This is an order preserving embedding.
\end{lemma}

\begin{definition}[Good enough topological space]
    \label{def:good_enough_topological_space}
    blackbox to mathlib???? 
\end{definition}

\begin{lemma}[Subset to sublocal Part 1]
(Leroy Proposition 5.1.1)
    \label{lem:subset_to_sublocal_part_1}
    \uses{lem:opens_correspond,lem:subset_sublocal,def:good_enough_topological_space}

    For two subspaces $X$ and $Y$ of $E$ and an open subspaces $U$ of $E$, we have:
    \begin{enumerate}
        \item $X \subset Y \implies [X] \subset [Y]$
        \item $X \subset U \iff [X] \subset [U]$
        \item If $E$ is a good enough topological space, then \[X \subset Y \iff [X] \subset [Y]\]
    \end{enumerate}
\end{lemma}

\begin{lemma}[Subset to sublocal Part 2]
(Leroy Proposition 5.1.2, 5.1.3)
    \label{lem:subset_to_sublocal_part_2}
    \uses{lem:open_closed_intersection}
    For an open subspace $U$ of $E$ and a subspace $X$ of $E$, we have:
    \begin{gather*}
    [U \cap X]
        = [U] \cap [X]\\
        F = E \setminus U\\
        [F] = [E] \\ [U]\\
        [X \cap F] = [X] \cap [F]\\
    \end{gather*}

\end{lemma}

%\begin{lemma}[(Prop 4) Unions of subspaces]
%(Leroy Proposition 5.1.4)
%    \label{lem:unions_of_subspaces}
%    For a family $X_i$ of subspaces of $E$, we have:
%    \[\bigcup_i [X_i] = [\bigcup_i X_i]\]
%\end{lemma}

\begin{lemma}[Part 3]
    \label{lem:subspaces_part_3}
    \uses{lem:open_closed_intersection,lem:subset_to_sublocal_part_2,def:further_topology}
    For any subspaces $X$ of E, we have:
    \begin{enumerate}
        \item \[Ext[X] = [Ext X]\]
        \item \[\bar{[X]} = [\bar{X}]\]
        \item \[[Int X] \subset Int[X]\]
        \item \[\partial[X] \subset [Fr(X)]\]
    \end{enumerate}
    For a good enough topological space $E$, we have equality in 3 and 4.
\end{lemma}


\begin{proposition}[Subset to sublocal preserves structure]
    \label{prop:subset_to_sublocal_structure}
    \uses{lem:subset_to_sublocal_part_1,lem:subset_to_sublocal_part_2,lem:subspaces_part_3}
    For two subspaces $X$ and $Y$ of $E$ and an open subspaces $U$ of $E$, we have:
    \begin{enumerate}
        \item $X \subset Y \implies [X] \subset [Y]$
        \item $X \subset U \iff [X] \subset [U]$
        \item If $E$ is a good enough topological space, then \[X \subset Y \iff [X] \subset [Y]\]
        \item \[[U \cap X] = [U] \cap [X]\]
        \item $\dots$
    \end{enumerate}

\end{proposition}

\begin{theorem}[Measure top to loc]
    \label{thm:measure_top_to_loc}
    \uses{lem:opens_correspond,lem:subset_sublocal,prop:subset_to_sublocal_structure,lem:regular_top_to_regular_local}
    Any measure on a good enough topological space $X$ induces a measure on the corresponding local. Furthermore, the classical caratheodory extension onto $\mathcal{P}(X)$ agrees with the restriction of the caratheodory extension of the induced measure on the local.
\end{theorem}



